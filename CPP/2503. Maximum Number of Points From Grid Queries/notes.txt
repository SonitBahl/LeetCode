Time Complexity: O(qlogq+mnlog(mn))
Space Complexity: O(mn+q)