Time Complexity: O(R + E)
Space Complexity: O(R + E + S)