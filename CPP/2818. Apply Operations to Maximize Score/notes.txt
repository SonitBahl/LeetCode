Time Complexity: O(n rootM + nlogn + nlogk)
Space Complexity: O(n)